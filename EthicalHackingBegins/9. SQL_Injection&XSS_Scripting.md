# SQL Injection

**SQL Injection** is a process of injecting malicious SQL statements into an application to manipulate the database query execution.
It occurs when user input is directly concatenated into an SQL statement without proper sanitization or parameterization.
Attackers exploit this vulnerability to bypass authentication, extract sensitive data, modify or delete records.

## Types of SQL Injection

* **Error-Based SQL Injection:** Exploits error messages to extract information.
    * Example: `' OR 1=CONVERT(int,@@version)--`
* **Time-Based SQL Injection:** Relies on conditional queries that delay response time.
    * Example: `' OR IF(SUBSTRING(@@version,1,1)='5',SLEEP(5),0)--`
* **Union-Based SQL Injection:** Uses UNION statements to retrieve data from other tables.
    * Example: `' UNION SELECT NULL,NULL,NULL--`
* **Blind SQL Injection:** Extracts data through boolean conditions (true/false responses).
    * Example: `' AND (SELECT CASE WHEN (username='admin') THEN 1 ELSE 0 END FROM users)=1--`

## Common Attack Vectors
* Login forms (e.g., `admin' --`)
* Search boxes (e.g., `' OR '1'='1`)
* Parameter manipulation (e.g., `?id=1 AND 1=1`)

## Mitigation Techniques
* Use **prepared statements** or **parameterized queries**.
* Implement **input validation** (regex checks).
* Apply **least privilege principle** for database accounts.
* Employ **WAF** (Web Application Firewall) rules.

### Example Exploit Code (Python)
```python
# Basic Python example using sqlite3
import sqlite3

def login(username, password):
    conn = sqlite3.connect('users.db')
    cursor = conn.cursor()
    # Vulnerable query
    query = f"SELECT * FROM users WHERE username='{username}' AND password='{password}'"
    result = cursor.execute(query).fetchall()
    return result
```

# Cross-Site Scripting (XSS)

**Cross-Site Scripting (XSS)** is a client-side injection technique where attackers inject malicious scripts into web pages viewed by other users.
These scripts execute in the victim's browser, potentially stealing cookies/session tokens or performing actions on behalf of the user.

## Types of XSS

* **Stored XSS:** Persistent payload stored server-side (e.g., comments section).
    * Example: `<img src=x onerror="alert(document.cookie)">`
* **Reflected XSS:** Non-persistent; payload reflected immediately in response.
    * Example: `?q=<script>fetch('/steal')</script>`
* **DOM-based XSS:** Occurs entirely in the client-side DOM manipulation.
    * Example: `document.location.hash = '<script>alert(1)</script>'`

## Attack Vectors
* Comment fields
* Search functionality
* URL parameters
* HTTP headers

## Mitigation Techniques
* Implement **Content Security Policy (CSP)**.
* Encode output using **HTML entity encoding**.
* Validate and sanitize input on both client and server.
* Use **SameSite cookie attribute**.

### Example Exploit Code (JavaScript)
```javascript
// Basic JavaScript example
function displayComment(comment) {
    document.getElementById('comments').innerHTML += comment;
}

// Attacker injects: <script>alert(document.cookie)</script>
```
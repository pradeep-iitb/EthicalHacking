# Wireshark

Wireshark works on all operating systems like windows , unix , macos , linux , etc .

## Uses of wireshark 
- Live Packet Capture 
- Analyse Data from other tools 
- Import and Analyse Hex Dumps 
- Export Data in different formats 
- Detailed packet analysis
- Create Statistics and graphs
- Decode encrypted data

#### 1. Capture Filter Syntax (BPF)
* **Format:** `protocol direction host`
* **No comparison operators** (`==`, `!=`) are used here.

| Goal | Command |
| :--- | :--- |
| Capture only traffic to/from an IP | `host 192.168.1.5` |
| Capture only specific port | `port 80` |
| Capture only TCP traffic | `tcp` |
| Exclude specific IP | `not host 192.168.1.1` |

#### 2. Display Filter Syntax
* **Format:** `protocol.field operator value`
* **Uses comparison operators** (`==`, `!=`, `>`, `contains`).

| Goal | Command |
| :--- | :--- |
| Show traffic to/from an IP | `ip.addr == 192.168.1.5` |
| Show specific port | `tcp.port == 80` |
| Show specific text in payload | `frame contains "password"` |
| Show only HTTP GET requests | `http.request.method == "GET"` |

# Wireshark Cheatsheet

## Default Columns In a Packet Capture Output
| Name | Description |
| :--- | :--- |
| **No.** | Frame number from the beginning of the packet capture. |
| **Time** | Seconds from the first frame. |
| **Source (src)** | Source address, commonly an IPv4, IPv6, or Ethernet address. |
| **Destination (dst)** | Destination address. |
| **Protocol** | Protocol used in the Ethernet frame, IP packet, or TCP segment. |
| **Length** | Length of the frame in bytes. |

## Logical Operators
| Operator | Description | Example |
| :--- | :--- | :--- |
| **and** / **&&** | Logical AND | All conditions must match. |
| **or** / **\|\|** | Logical OR | Either all or one of the conditions must match. |
| **xor** / **^^** | Logical XOR | Exclusive alternation - only one of the two conditions should match, not both. |
| **not** / **!** | Not (Negation) | Not equal to. |
| **[ n ]** / **[ … ]** | Substring operator | Filter a specific word or text. |

## Filtering Packets (Display Filters)
| Operator | Description | Example |
| :--- | :--- | :--- |
| **eq** / **==** | Equal | `ip.dst == 192.168.1.1` |
| **ne** / **!=** | Not equal | `ip.dst != 192.168.1.1` |
| **gt** / **>** | Greater than | `frame.len > 10` |
| **lt** / **<** | Less than | `frame.len < 10` |
| **ge** / **>=** | Greater than or equal | `frame.len >= 10` |
| **le** / **<=** | Less than or equal | `frame.len <= 10` |

## Filter Types & Modes
| Name | Description |
| :--- | :--- |
| **Capture filter** | Filter packets **during** capture (discards non-matching packets). |
| **Display filter** | Hide packets from a capture **display** (non-destructive). |
| **Promiscuous mode** | Sets interface to capture **all** packets on a network segment. |
| **Monitor mode** | Setup wireless interface to capture all traffic it can receive (Unix/Linux only). |

## Miscellaneous
| Name | Description |
| :--- | :--- |
| **Slice Operator** | `[ … ]` - Range of values |
| **Membership Operator** | `{}` - In |
| **Start/Stop Capturing** | `Ctrl + E` |

---

## Filter Syntax Examples

### Capture Filter Syntax
| Protocol | Direction | Host | Value | Logical Operator | Expression |
| :--- | :--- | :--- | :--- | :--- | :--- |
| `tcp` | `src` | `192.168.1.1` | `80` | `and` | `tcp dst 202.164.30.1` |

### Display Filter Syntax
| Protocol | String 1 | String 2 | Comparison | Value | Logical Operator | Expression |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| `http` | `request` | `uri` | `==` | `"/login"` | `and` | `ip.src == 192.168.1.1` |

---

## Keyboard Shortcuts - Main Display Window

| Accelerator | Description |
| :--- | :--- |
| **Tab** or **Shift+Tab** | Move between screen elements (e.g., toolbars to packet list). |
| **Alt+→** or **Option+→** | Move to the next packet in the selection history. |
| **↓** | Move to the next packet or detail item. |
| **→** | In packet detail, opens the selected tree item. |
| **↑** | Move to the previous packet or detail item. |
| **Shift+→** | In packet detail, opens the selected tree item and all subtrees. |
| **Ctrl+↓** or **F8** | Move to the next packet, even if the packet list isn't focused. |
| **Ctrl+→** | In packet detail, opens all tree items. |
| **Ctrl+↑** or **F7** | Move to the previous packet, even if the packet list isn't focused. |
| **Ctrl+←** | In packet detail, closes all the tree items. |
| **Ctrl+.** | Move to the next packet of the conversation (TCP, UDP, or IP). |
| **Backspace** | In packet detail, jumps to the parent node. |
| **Ctrl+,** | Move to the previous packet of the conversation. |
| **Return** or **Enter** | In packet detail, toggles the selected tree item. |

## Protocols - Common Values
`ether`, `fddi`, `ip`, `arp`, `rarp`, `decnet`, `lat`, `sca`, `moprc`, `mopdl`, `tcp`, `udp`

| Usage | Filter Syntax |
| :--- | :--- |
| **Filter by IP** | `ip.addr == 10.10.50.1` |
| **Filter by Destination IP** | `ip.dst == 10.10.50.1` |
| **Filter by Source IP** | `ip.src == 10.10.50.1` |
| **Filter by IP Range** | `ip.addr >= 10.10.50.1 and ip.addr <= 10.10.50.100` |
| **Filter by Multiple IPs** | `ip.addr == 10.10.50.1 or ip.addr == 10.10.50.100` |
| **Filter out IP Address** | `!(ip.addr == 10.10.50.1)` |
| **Filter Subnet** | `ip.addr == 10.10.50.0/24` |
| **Filter by Port** | `tcp.port == 25` |
| **Filter by Destination Port** | `tcp.dstport == 23` |
| **Filter by IP and Port** | `ip.addr == 10.10.50.1 and tcp.port == 25` |
| **Filter by URL** | `http.host == "example.com"` |
| **Filter by Timestamp** | `frame.time >= "June 02, 2019 18:04:00"` |
| **Filter SYN Flag (TCP Handshake)** | `tcp.flags.syn == 1 and tcp.flags.ack == 0` |
| **Filter RST Flag** | `tcp.flags.reset == 1` |
| **Beacon Frame Filter** | `wlan.fc.type_subtype == 0x08` |
| **Broadcast Filter** | `eth.dst == ff:ff:ff:ff:ff:ff` |
| **Multicast Filter** | `(eth.dst[0] & 1)` |
| **Filter by Hostname** | `ip.host == "hostname"` |
| **Filter by MAC Address** | `eth.addr == 00:70:f4:23:18:c4` |


# Wireshark Statistics Menu Breakdown

1.  **Capture File Properties** - 
    Displays global metadata about the capture file, such as hardware used, OS, capture time, interface, and total packet counts.

2.  **Resolved Addresses** - 
    Lists all addresses (MAC, IP, Port) found in the capture that Wireshark successfully resolved to a human-readable hostname or service name.

3.  **Protocol Hierarchy** - 
    A tree view showing the distribution of protocols in the capture (e.g., 100% Ethernet -> 90% IP -> 80% TCP), useful for a quick traffic overview.

4.  **Conversations** - 
    Lists traffic between two specific endpoints (IP A <-> IP B). Helps identify who is talking to whom and the volume of data exchanged.

5.  **Endpoints** - 
    Lists every unique device (identified by IP, MAC, or Port) seen in the network traffic, regardless of who they are talking to.

6.  **Packet Lengths** - 
    Displays a histogram of packet sizes. Useful for spotting fragmentation (small packets) or large file transfers (large packets).

7.  **I/O Graphs** - 
    Visualizes traffic throughput over time (bits/sec or packets/sec). excellent for spotting spikes, bursts, or connection drops.

8.  **Service Response Time** - 
    Calculates the time gap between a request and its response for supported protocols (like SMB, LDAP), helping measure server latency.

9.  **DHCP (BOOTP) Statistics** - 
    Shows counts of DHCP messages like Discover, Offer, Request, and Ack to troubleshoot IP address assignment issues.

10. **NetPerfMeter Statistics** - 
    Provides performance metrics specifically for the NetPerfMeter protocol, used for measuring network performance.

11. **ONC-RPC Programs** - 
    Statistics for Open Network Computing Remote Procedure Calls, listing the programs and procedures called.

12. **29West** - 
    Statistics for the 29West low-latency messaging protocol (often used in financial trading).

13. **ANCP** - 
    Statistics for the Access Node Control Protocol, used in broadband aggregation networks.

14. **BACnet** - 
    Statistics for Building Automation and Control networks. Options include sorting packets by Instance ID, IP, Object Type, or Service.

15. **Collectd** - 
    Displays data related to `collectd`, a Unix daemon that collects system performance statistics.

16. **DNS** - 
    Detailed stats on DNS traffic, including query types (A, MX, etc.) and response codes (NXDOMAIN, No Error).

17. **Flow Graph** - 
    Generates a vertical time-sequence diagram (ladder chart) showing the flow of packets between hosts, useful for visualizing handshakes.

18. **HART-IP** - 
    Statistics for the Highway Addressable Remote Transducer protocol, used in industrial automation.

19. **HPFEEDS** - 
    Statistics for the HPFeeds protocol, a lightweight authenticated feed protocol often used for honeypot data.

20. **HTTP** - 
    Web traffic analysis, including breakdown of request methods (GET, POST), response codes, and load distribution.

21. **HTTP2** - 
    Specific statistics for HTTP/2 traffic, including frame types and stream analysis.

22. **Sametime** - 
    Statistics for the Lotus Sametime instant messaging and conferencing protocol.

23. **TCP Stream Graphs** - 
    Advanced visualizations for TCP streams, including Round Trip Time (RTT), Throughput, and Time-Sequence graphs.

24. **UDP Multicast Streams** - 
    Analysis of UDP multicast traffic, showing stream rates, burstiness, and packet loss metrics.

25. **Reliable Server Pooling (RSerPool)** - 
    Statistics for the RSerPool protocol, which manages pools of servers for high availability.

26. **SOME/IP** - 
    Statistics for "Scalable service-Oriented MiddlewarE over IP," a protocol used in automotive ethernet.

27. **DTN** - 
    Statistics for Delay-Tolerant Networking protocols (like Bundle Protocol), used in challenged networks.

28. **F5** - 
    Decodes and displays statistics specific to F5 Networks load balancer headers and trailers.

29. **IPv4 Statistics** - 
    General statistics for IPv4 traffic, including source/destination IP lists and IP protocol types.

30. **IPv6 Statistics** - 
    General statistics for IPv6 traffic, similar to IPv4 but specific to the newer addressing scheme.